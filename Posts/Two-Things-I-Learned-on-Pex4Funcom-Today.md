---
tags:
- pex
- code contracts
- moles
- unit testing
- csharp
- dotnet
menuorder: 0
id: b4d0b40f-8268-4cdd-a102-fec4317f463c
author: bsstahl
title: Two Things I Learned on Pex4Fun.com Today
description: 
ispublished: true
showinlist: false
publicationdate: 2010-11-12T20:45:00.000+00:00
lastmodificationdate: 2010-11-12T20:52:08.000+00:00
slug: Two-Things-I-Learned-on-Pex4Funcom-Today
categories:
- Development

---
Since I’m a fan of puzzles, I’ve been spending a bit of time on [PexForFun.com](https://web.archive.org/web/20101112142013/http://www.pexforfun.com/) lately.  This site was put together by the Pex team (part of Microsoft Research) to show off the capabilities of some of the research group’s  latest creations; Pex, Moles, and Code Contracts.  I’ve been enjoying this site because it gives me the opportunity to solve some coding puzzles, while at the same time discovering things about these new tools.  Today alone, I discovered the following:

## The order of Contract.Requires() in Code Contracts matters.

Though it doesn’t seem like it should matter (at least to me), the order that code contracts are specified does seem to matter at execution, at least in some circumstances, if runtime checking is enabled.  For example, in my *ChallengeAuction* code duel there is a practical limit to how many bids may be supplied since Pex has to test each of the data elements.  Defining this limit in as a Contract.Requires() element works well as long as that statement is placed before a statement testing the data elements, such as one verifying that the key for each bid is not an empty string.  Reversing the order of these contract statements causes the test to occur for each data element of the dictionary, and a “path bounds exceeded” error to be generated by Pex.

## Pex doesn’t generate more than 1 Dictionary value for any test dataset.

The same code duel, *ChallengeAuction* pointed out to me that apparently, Pex only generates 1 data element in a dictionary.  That is, in the *Dictionary<TKey, TValue>* defined for bids in the code duel, Pex generates a Dictionary object of various sizes, but only supplies 1 data element within the Dictionary.  This means that a number of code paths are not being verified since it is important in this duel to test whether or not the highest bid wins the auction.  If you try the duel, you could actually fool Pex into thinking you have a successful solution even with a method that returns the lowest or first bids as the winning bid.

I have posted this as a question on the [Pex and Moles PowerTool](https://social.msdn.microsoft.com/Forums/en-US/72927f79-05e7-4bdf-836c-25238ffd7192/pex-doesnt-generate-more-than-1-dictionary-value?forum=pex) forum and have yet to receive a response.

I highly recommend checking out [PexForFun.com](https://web.archive.org/web/20101112142013/http://www.pexforfun.com/). Try a few code duels and perhaps create a few of your own.  I have created several code duels which you are welcome to try and solve:

* *FabulousMrFib*
* *ChallengeEarnies*
* *ChallengeAuction*
* *ChallengeContractSubstring*
